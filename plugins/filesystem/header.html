<script>
	function insertAtCursor(myField, myValue) {
	    if (document.selection) { // IE, Edge, etc.
	        myField.focus();
	        sel = document.selection.createRange();
	        sel.text = myValue;
	    } else if (myField.selectionStart || myField.selectionStart == '0') { // Chrome, Firefox, etc.
	        var startPos = myField.selectionStart;
	        var endPos = myField.selectionEnd;
	        myField.value = myField.value.substring(0, startPos) + myValue + myField.value.substring(endPos, myField.value.length);
	    } else { // fallback
	        myField.value += myValue;
	    }
	}
	
	function onFileClick(filename) {
		insertAtCursor(mostRecentInput, "'" + filename + "'");
		mostRecentInput.focus();
		scrollDown();
	}
</script>
